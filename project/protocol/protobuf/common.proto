syntax = "proto3";
import "google/protobuf/empty.proto";
option go_package = "./pb";

enum ProtocolId {
	ServerHello = 0;
	Server2Client = 1;
	Login = 101; // req: LoginC2S, res: LoginS2C
	Logout = 102; // req: LogoutC2S, res: LogoutS2C
	Common = 103; // req: CommonC2S, res: CommonS2C
}

message ServerInfo {
	int32 Id = 1;
	string Type = 2;
	string Address = 3;
	repeated int32 MsgHandlers = 4;
}

// 客户端请求
message ClientRequest {
	string session_id = 1;      // 会话ID
	int32 msg_id = 2;           // 消息ID
	bytes payload = 3;          // 消息体
}

// 服务器响应
message ServerResponse {
	string session_id = 1;      // 会话ID
	int32 msg_id = 2;           // 消息ID
	bytes payload = 3;          // 响应体
}

// 服务注册握手
service RegistryService {
	rpc HelloShake(ServerInfo) returns (google.protobuf.Empty);
}

// 心跳判活
service HeartBeatPingService {
	rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}

// 消息处理接口
service MessageService {
	rpc HandleMessage(ClientRequest) returns (ServerResponse);
}

// 消息通知接口
service NotifyService {
	rpc NotifyMessage(ClientRequest) returns (google.protobuf.Empty);
}

message LoginC2S {
	int32 RoleId = 1;
}
message LoginS2C {
	int32 Error = 1;
	string Data = 2;
}

message LogoutC2S {
	int32 RoleId = 1;
}
message LogoutS2C {
	int32 Error = 1;
}

message CommonC2S {
	int32 RoleId = 1;
}
message CommonS2C {
	int32 Error = 1;
}

message ErrorHint {
	string Hint = 1;
}